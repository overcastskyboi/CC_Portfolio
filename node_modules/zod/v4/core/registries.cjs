"use strict";
<<<<<<< HEAD
<<<<<<< HEAD
var _a;
=======
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
=======
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
Object.defineProperty(exports, "__esModule", { value: true });
exports.globalRegistry = exports.$ZodRegistry = exports.$input = exports.$output = void 0;
exports.registry = registry;
exports.$output = Symbol("ZodOutput");
exports.$input = Symbol("ZodInput");
class $ZodRegistry {
    constructor() {
<<<<<<< HEAD
<<<<<<< HEAD
        this._map = new WeakMap();
=======
        this._map = new Map();
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
=======
        this._map = new Map();
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
        this._idmap = new Map();
    }
    add(schema, ..._meta) {
        const meta = _meta[0];
        this._map.set(schema, meta);
        if (meta && typeof meta === "object" && "id" in meta) {
<<<<<<< HEAD
<<<<<<< HEAD
=======
            if (this._idmap.has(meta.id)) {
                throw new Error(`ID ${meta.id} already exists in the registry`);
            }
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
=======
            if (this._idmap.has(meta.id)) {
                throw new Error(`ID ${meta.id} already exists in the registry`);
            }
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
            this._idmap.set(meta.id, schema);
        }
        return this;
    }
    clear() {
<<<<<<< HEAD
<<<<<<< HEAD
        this._map = new WeakMap();
=======
        this._map = new Map();
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
=======
        this._map = new Map();
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
        this._idmap = new Map();
        return this;
    }
    remove(schema) {
        const meta = this._map.get(schema);
        if (meta && typeof meta === "object" && "id" in meta) {
            this._idmap.delete(meta.id);
        }
        this._map.delete(schema);
        return this;
    }
    get(schema) {
        // return this._map.get(schema) as any;
        // inherit metadata
        const p = schema._zod.parent;
        if (p) {
            const pm = { ...(this.get(p) ?? {}) };
            delete pm.id; // do not inherit id
<<<<<<< HEAD
<<<<<<< HEAD
            const f = { ...pm, ...this._map.get(schema) };
            return Object.keys(f).length ? f : undefined;
=======
            return { ...pm, ...this._map.get(schema) };
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
=======
            return { ...pm, ...this._map.get(schema) };
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
        }
        return this._map.get(schema);
    }
    has(schema) {
        return this._map.has(schema);
    }
}
exports.$ZodRegistry = $ZodRegistry;
// registries
function registry() {
    return new $ZodRegistry();
}
<<<<<<< HEAD
<<<<<<< HEAD
(_a = globalThis).__zod_globalRegistry ?? (_a.__zod_globalRegistry = registry());
exports.globalRegistry = globalThis.__zod_globalRegistry;
=======
exports.globalRegistry = registry();
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
=======
exports.globalRegistry = registry();
>>>>>>> 100f0e1 (feat: implement routing, watchlist overhaul, and decommission console)
